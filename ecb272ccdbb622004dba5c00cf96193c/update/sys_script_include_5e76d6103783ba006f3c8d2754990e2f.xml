<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_script_include">
    <sys_script_include action="INSERT_OR_UPDATE">
        <access>public</access>
        <active>true</active>
        <api_name>x_sigr_sisk_hr_co.SISK_HR_Contract_No_Ajax</api_name>
        <client_callable>true</client_callable>
        <description>Custom script used to return information</description>
        <name>SISK_HR_Contract_No_Ajax</name>
        <script><![CDATA[// use  var ss = new SISK_HR_Contract_No_Ajax(); to initialise

var SISK_HR_Contract_No_Ajax = Class.create();
SISK_HR_Contract_No_Ajax.prototype = {
	initialize: function() {
	},
	
	//return true if user has permissions to view the full contract
	getPermissionList: function(sys_id){
		var permissionList = '';
		var director = '';
		var asmtGrp = '';
		
		gs.info("getPermissionList called");
		//get the ato revotd
		var gr = new GlideRecord('x_sigr_sisk_hr_co_authority_to_offer');
		gr.addQuery('sys_id',sys_id);
		gr.query();
		
		while(gr.next()) {
			permissionList += gr.opened_by +','; //opened by
			permissionList += gr.local_director +','; //regional director
			permissionList += gr.finance_director +','; // financial directoe
			permissionList += gr.watch_list.toString() +','; //record watchlist
			
			director = gr.director; //reference to sisk director
			asmtGrp = gr.assignment_group;	//reference to assignment group
		}
		
		gr = new GlideRecord('x_sigr_sisk_hr_co_sisk_directors');
		gr.addQuery('sys_id',director);
		gr.query();
		
		while(gr.next()) {
			permissionList += gr.name +','; //MD Director
			permissionList += gr.watchlist.toString() +','; // Director Watchlist
		}
		
		gr = new GlideRecord('sys_user_grmember');
		gr.addQuery('group', asmtGrp);
		gr.query();
		
		while(gr.next()) {
			permissionList += gr.user +','; //user in assigment group
		}
		
		gs.info("Permission List {0} - userId {1}", permissionList, userId);
		return permissionList;
	},
	
	type: 'SISK_HR_Contract_No_Ajax'
};]]></script>
        <sys_class_name>sys_script_include</sys_class_name>
        <sys_created_by>r.callan@siskgroup.ie</sys_created_by>
        <sys_created_on>2017-05-26 14:46:58</sys_created_on>
        <sys_customer_update>true</sys_customer_update>
        <sys_id>5e76d6103783ba006f3c8d2754990e2f</sys_id>
        <sys_mod_count>4</sys_mod_count>
        <sys_name>SISK_HR_Contract_No_Ajax</sys_name>
        <sys_package display_value="Sisk Hr Contracts" source="x_sigr_sisk_hr_co">ecb272ccdbb622004dba5c00cf96193c</sys_package>
        <sys_policy/>
        <sys_replace_on_upgrade>false</sys_replace_on_upgrade>
        <sys_scope display_value="Sisk Hr Contracts">ecb272ccdbb622004dba5c00cf96193c</sys_scope>
        <sys_update_name>sys_script_include_5e76d6103783ba006f3c8d2754990e2f</sys_update_name>
        <sys_updated_by>r.callan@siskgroup.ie</sys_updated_by>
        <sys_updated_on>2017-05-26 15:05:25</sys_updated_on>
    </sys_script_include>
</record_update>
